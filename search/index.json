[{"content":" æœ€è¿‘é¢è©¦è¢«å•åˆ°æœ‰é—œ Transaction çš„å•é¡Œæ™‚ï¼Œå¹¾ä¹ç­”ä¸å‡ºä¾†Orzï¼Œè¶•ç·ŠæŸ¥è³‡æ–™ä¾†å£“å£“é©šã€‚\né€™ç¯‡æˆ‘æœƒå¾å®˜æ–¹æ–‡ä»¶åŠç¶²è·¯æ–‡ç« æ“·å–éƒ¨åˆ†å…§å®¹ï¼Œè©¦è‘—ç†è§£ Postgres ä¸­çš„ Transaction ï¼Œç”¨ Docker å»ºç«‹ Postgres ä¾†åšå¯¦é©—ï¼Œè©¦è‘—é‡ç¾å…¶ä¸­å¹¾ç¨®ç‹€æ³ï¼Œç”±æ–¼æˆ‘å€‹äººç†è§£ç¨‹åº¦é‚„ä¸å¤ æ·±ï¼Œå»ºè­°å»é–±è®€åƒè€ƒè³‡æºçš„æ–‡ç« æœƒæ”¶ç©«æ›´å¤šå–”ï¼\nå…ˆä¾†ä¸€æ®µå®˜æ–¹çš„ä»‹ç´¹ï¼Œè©³ç´°çš„å…§å®¹åœ¨ PostgreSQL MVCC ç°¡ä»‹ã€‚\nPostgreSQL ç‚ºé–‹ç™¼è€…å€‘æä¾›äº†è±å¯Œçš„å·¥å…·ä¾†ç®¡ç†è³‡æ–™çš„ åŒæ™‚å­˜å–ã€‚è³‡æ–™çš„ ä¸€è‡´æ€§ åœ¨è³‡æ–™åº«å…§éƒ¨æ˜¯ä»¥ å¤šé‡è³‡æ–™ç‰ˆæœ¬çš„æ–¹å¼ç¶­è­·ï¼ˆMultiversion Concurrency Controlï¼ŒMVCCï¼‰ï¼Œé€™è¡¨ç¤ºç„¡è«–ç›®å‰è³‡æ–™çš„ç•¶ä¸‹ç‹€æ…‹å¦‚ä½•ï¼Œæ¯å€‹ SQL æŒ‡ä»¤æœƒçœ‹è¦‹çš„æ˜¯è³‡æ–™åœ¨ä¸€æ®µæ™‚é–“å‰çš„ å¿«ç…§ ï¼ˆè³‡æ–™åº«çš„æŸå€‹ç‰ˆæœ¬ï¼‰ã€‚\nè€ŒMVCCé€™å€‹åŠŸèƒ½å¤§å¤šæ•¸è³‡æ–™åº«å·²ç¶“å¯¦ç¾äº†ï¼Œè©³ç´°åƒè€ƒ ç¶­åŸºç™¾ç§‘-å¤šç‰ˆæœ¬ä¸¦è¡Œæ§åˆ¶ ã€‚\né€™æ¬¡å¯¦é©—çš„ç¯„åœä»¥ äº¤æ˜“éš”é›¢(Transaction Isolation) ç‚ºä¸» ï¼Œä»¥æˆ‘å€‹äººæ ¹æ“šå®˜æ–¹æ‰‹å†Šæä¾›çš„è§£é‡‹åŠç¯„ä¾‹ä¾†åšå¯¦é©—ï¼Œè‹¥éç¨‹ä¸­æœ‰éŒ¯èª¤èªçŸ¥ä¹Ÿè«‹ä¸åå‘ŠçŸ¥ï¼\nå°è©¦èº«æ‰‹ å¯ä»¥å…ˆåˆ° Crunchydata Tutorials - Transactions å»è©¦ä¸€é postgres ä¸­çš„ transaction è¡Œç‚ºï¼Œç…§è‘—åšä¹‹å¤–ä¹Ÿå¯ä»¥å»è©¦è‘—ç†è§£æ•™å­¸çš„é‡é»å–”ï¼\nSQL Transaction åœ¨å¯¦é©—å‰å…ˆä¾†è¤‡ç¿’ä¸€ä¸‹ è³‡æ–™åº«äº¤æ˜“è¡Œç‚º(Transaction) çš„ç‰¹æ€§ï¼Œä»¥ä¸‹ç¯€éŒ„è‡ª SQL å¤§å°äº‹ - Po-Ching **Liuã€‚**\nåœ¨è³‡æ–™åº«ä¸­ï¼Œäº¤æ˜“(äº‹å‹™) æ„æ—¨ç”±å„ç¨® è³‡æ–™åº«æ“ä½œ(selectã€updateã€insertç­‰) æ‰€çµ„æˆçš„é‚è¼¯éç¨‹ã€‚\nåœ¨è³‡æ–™åº«ä¸­ç‚ºä¿è­‰å…¶äº¤æ˜“æ˜¯æ­£ç¢ºä¸”å¯é çš„ï¼Œå¿…éœ€æ»¿è¶³ä»¥ä¸‹ å››å€‹ç‰¹æ€§ ï¼š\nåŸå­æ€§(Atomicity)\nåœ¨è³‡æ–™åº«çš„æ¯ä¸€ç­†äº¤æ˜“ä¸­åªæœ‰å…©ç¨®å¯èƒ½ç™¼ç”Ÿï¼Œç¬¬ä¸€ç¨®æ˜¯å…¨éƒ¨å®Œå…¨(commit)ï¼Œç¬¬äºŒç¨®æ˜¯å…¨éƒ¨ä¸å®Œæˆ(rollback)ï¼Œä¸æœƒå› ç‚ºæŸå€‹ç’°ç¯€å‡ºéŒ¯ï¼Œè€Œçµ‚æ­¢åœ¨é‚£å€‹ç’°ç¯€ï¼Œåœ¨å‡ºéŒ¯ä¹‹å¾Œæœƒæ¢å¾©è‡³äº¤æ˜“ä¹‹å‰çš„ç‹€æ…‹ï¼Œå¦‚åŒé‚„æ²’åŸ·è¡Œæ­¤ç­†äº¤æ˜“ã€‚ ä¸€è‡´æ€§(Consistency)\nåœ¨äº¤æ˜“ä¸­æœƒç”¢ç”Ÿè³‡æ–™æˆ–è€…é©—è­‰ç‹€æ…‹ï¼Œç„¶è€Œç•¶éŒ¯èª¤ç™¼ç”Ÿï¼Œæ‰€æœ‰å·²æ›´æ”¹çš„è³‡æ–™æˆ–ç‹€æ…‹å°‡æœƒæ¢å¾©è‡³äº¤æ˜“ä¹‹å‰ã€‚ éš”é›¢æ€§(Isolation)\nè³‡æ–™åº«å…è¨±å¤šç­†äº¤æ˜“åŒæ™‚é€²è¡Œï¼Œäº¤æ˜“é€²è¡Œæ™‚æœªå®Œæˆçš„äº¤æ˜“è³‡æ–™ä¸¦ä¸æœƒè¢«å…¶ä»–äº¤æ˜“ä½¿ç”¨ï¼Œç›´åˆ°æ­¤ç­†äº¤æ˜“å®Œæˆã€‚ æŒçºŒæ€§(Durability)\näº¤æ˜“å®Œæˆå¾Œå°è³‡æ–™çš„ä¿®æ”¹æ˜¯æ°¸ä¹…æ€§çš„ï¼Œè³‡æ–™ä¸æœƒå› ç‚ºç³»çµ±é‡å•Ÿæˆ–éŒ¯èª¤è€Œæ”¹è®Šã€‚ ä»€éº¼æ˜¯ äº¤æ˜“éš”é›¢(Transaction Isolation) ? ä»¥ä¸‹ç¯€éŒ„è‡ª PostgreSQL äº¤æ˜“éš”é›¢ åŠ è³‡æ–™åº« Transaction \u0026amp; Lock ç­†è¨˜ã€‚\nåœ¨ä¸åŒç­‰ç´šä¸­ç™¼ç”Ÿ ç«¶çˆ­æ¢ä»¶(Race condition) æ˜¯ï¼š\nDirty write (é«’å¯«)\ntransaction å°šæœª commit çš„æƒ…æ³ä¸‹ï¼Œå…¶å€¼è¢«å¦ä¸€å€‹ transaction çµ¦è¦†å¯«ã€‚ Dirty read (é«’è®€)\ntransaction è®€å–çš„è³‡æ–™æ˜¯ç”±å°šæœª commit çš„ concurrency transaction å¯«å…¥çš„ã€‚ Non-repeatable read (ç„¡æ³•é‡è¤‡çš„è®€å–)\nåˆå¯ç¨±ä½œ è®€å–åå·®(read skew) ï¼Œtransaction é‡æ–°è®€å–å®ƒä¹‹å‰è®€éçš„è³‡æ–™ï¼Œä½†æ˜¯å»ç™¼ç¾è³‡æ–™è¢«å…¶ä»– transaction ä¿®æ”¹ï¼ˆåœ¨æœ€åˆè®€å–ä¹‹å¾Œcommitï¼‰äº†ã€‚ Phantom read (å¹»è®€)\nåˆå¯ç¨±ä½œ å¯«å…¥åå·®(wirte skew) ï¼Œtransaction é‡æ–°åŸ·è¡ŒæŸ¥è©¢ï¼Œå¾—åˆ°æ»¿è¶³æœå°‹æ¢ä»¶çš„è³‡æ–™é›†ï¼Œä½†å»ç™¼ç¾å¾—åˆ°çš„è³‡æ–™é›†å› ç‚ºå…¶ä»–æœ€è¿‘å‰› commit çš„ transaction è€Œè®Šæ›´äº†ã€‚ Serialization anomaly (åºåˆ—åŒ–ç•°å¸¸)\nåœ¨æˆåŠŸæäº¤ä¸€ç¾¤ transactions å¾Œï¼Œçµæœèˆ‡ä»¥æ‰€æœ‰å¯èƒ½çš„é †åºä¾åºåŸ·è¡Œäº¤æ˜“çš„çµæœéƒ½ä¸ä¸€è‡´ã€‚ SQL æ¨™æº–ä¸­å®šç¾©äº†å››å€‹ç­‰ç´šçš„äº¤æ˜“éš”é›¢ :\nRead uncommitted : ä»£è¡¨ transaction å¯ä»¥è®€åˆ°åˆ¥çš„ transaction å°šæœª commit çš„è³‡æ–™ï¼Œåœ¨é€™å€‹ç­‰ç´šä¸­ race condition ä¸‰å€‹å•é¡Œéƒ½æ²’æœ‰è§£æ±ºã€‚ Read committed : ä»£è¡¨ transaction åªèƒ½è®€åˆ°åˆ¥çš„ transaction å·²ç¶“ commit çš„è³‡æ–™ï¼Œæ²’æœ‰ commit çš„è©±å°±ä¸æœƒè®€åˆ°ï¼Œåœ¨é€™å€‹ç­‰ç´šè§£æ±ºäº† Dirty read çš„å•é¡Œï¼Œç‚º Postgres é è¨­ç­‰ç´šã€‚ Repeatable read : ä»£è¡¨æ¯æ¬¡ transaction è¦è®€å–ç‰¹å®šæ¬„ä½çš„è³‡æ–™æ™‚ï¼Œåªè¦ query æ¢ä»¶ç›¸åŒï¼Œè®€å–åˆ°çš„è³‡æ–™å…§å®¹å°±æœƒç›¸åŒï¼Œåœ¨é€™å€‹ç­‰ç´šè§£æ±ºäº† Non-repeatable read çš„å•é¡Œï¼Œç‚º MYSQL InnoDB é è¨­ç­‰ç´š ã€‚ Serializable : ä»£è¡¨åœ¨å¤šå€‹ transaction åŒæ™‚åŸ·è¡Œæ™‚ï¼Œåªè¦ transaction çš„é †åºç›¸åŒæ™‚ï¼Œå¾—åˆ°çš„çµæœä¸€å®šç›¸åŒã€‚æ¯”å¦‚èªª Transaction A å…ˆåŸ·è¡Œäº†æ¥ä¸‹ä¾†å†åŸ·è¡Œ Transaction Bï¼Œåœ¨åŒæ¨£çš„æ¢ä»¶ä¸‹ï¼Œæ¯æ¬¡åŸ·è¡Œéƒ½æœƒå¾—åˆ°ä¸€æ¨£çš„çµæœï¼Œåœ¨é€™å€‹ç­‰ç´šä¸‹é€£åŒ Phantom read ä¹Ÿæœƒä¸€ä½µè¢«è§£æ±ºã€‚ äº¤æ˜“éš”é›¢ç­‰ç´šèˆ‡ç«¶çˆ­æ¢ä»¶ éš”é›¢ç­‰ç´š Dirty write Dirty read Non-repeatable read Phantom read Serialization anomaly Read uncommitted ä¸å¯èƒ½ å…è¨±ï¼Œä½†PGä¸­ä¸æœƒ å¯èƒ½ å¯èƒ½ å¯èƒ½ Read committed ä¸å¯èƒ½ ä¸å¯èƒ½ å¯èƒ½ å¯èƒ½ å¯èƒ½ Repeatable read ä¸å¯èƒ½ ä¸å¯èƒ½ ä¸å¯èƒ½ å…è¨±ï¼Œä½†PGä¸­ä¸æœƒ å¯èƒ½ Serializable ä¸å¯èƒ½ ä¸å¯èƒ½ ä¸å¯èƒ½ ä¸å¯èƒ½ ä¸å¯èƒ½ è³‡æ–™å·¥ç¨‹å¸«ä¿®ç…‰ä¹‹è·¯ Part II IThome éµäººè³½ä¸­çš„ç³»åˆ—æ–‡ç« ï¼Œæœ‰é™„åœ–è€Œä¸”è§£é‡‹çš„æ›´è©³ç´°ï¼Œéå¸¸æ¨è–¦å»é–±è®€ï¼\nå¯¦é©—ç’°å¢ƒ Mac M1 Docker 20.10.17 Docker Compose 2.2.3 Docker Image: postgres:14-alpine æ¨¡æ“¬ race condition ç™¼ç”Ÿ ç”±æ–¼åœ¨ RDBMS ä¸­çš„ transaction ä¸å…è¨± dirty write(é«’å¯«) çš„ç‹€æ³ç™¼ç”Ÿï¼Œæœ‰é—œå…¶ç‹€æ³å¯ä»¥åƒè€ƒå…¶ä»–æ–‡ç« è§£é‡‹ï¼Œè€Œ serialization anomaly(åºåˆ—åŒ–ç•°å¸¸) æˆ‘é‚„ä¸æ¸…æ¥šå¦‚ä½•é‡ç¾ğŸ¥²ï¼Œdirty read(é«’è®€) åœ¨ postgres ä¸­ä¹Ÿè¢«é™åˆ¶ï¼Œé€™é‚Šå°±å…ˆè©¦è‘—é‡ç¾ä¸€ç¨® race condition çš„ç‹€æ³ï¼Œä¸¦è§€å¯Ÿä¿®æ”¹ isolation ç­‰ç´šå‰å¾Œçš„çµæœã€‚\nNon - Repeatable Read(Read skew) æ¨¡æ“¬åœ¨ Read committed ç­‰ç´šåº•ä¸‹æœƒç™¼ç”Ÿçš„å•é¡Œã€‚\nåƒè€ƒä»¥ä¸‹æƒ…å¢ƒé€²è¡Œå¯¦é©—ï¼š\nAlice æ“æœ‰å…©å€‹éŠ€è¡Œå¸³æˆ¶ï¼Œå„æœ‰ 500 å…ƒåœ¨å¸³æˆ¶ä¸­ï¼Œå…±æœ‰ 1000 å…ƒ æœ‰å€‹è½‰å¸³ä½œæ¥­ç™¼èµ· transaction å¾ Account 1 è½‰å¸³è‡³ Account 2 Alice ç™¼èµ·çš„ transaction åœ¨è½‰å¸³å‰æŸ¥äº† Account 1 ï¼Œåœ¨è½‰å¸³å¾ŒæŸ¥äº† Account 2ï¼Œå¾—åˆ°ç¸½é¡ 900å…ƒçš„è³‡è¨Šï¼Œç™¼ç¾ç¸½é‡‘é¡å°‘äº† 100 å…ƒï¼Œä½†å¸³æˆ¶ä¸­ç¸½é¡ç¢ºå¯¦ç‚º 1000 å…ƒ Alice éœ€è¦å†æ¬¡æŸ¥è©¢æ‰å¯å–å¾—æ­£ç¢ºçš„çµæœ é€™å€‹æƒ…å¢ƒä¸‹ç¬¦åˆ Read committed ç­‰ç´šä¸­å…è¨±è®€å–å·² committed çš„è³‡æ–™ï¼Œä½†æ²’æœ‰ä¿è­‰åœ¨åŒä¸€å€‹ transaction ä¸‹ï¼Œæ‰€å–å¾—çš„è³‡æ–™éƒ½æ˜¯åŒä¸€ä»½ã€‚\nGitHub repoï¼š https://github.com/zeroLR/first-try-transaction-isolation\nå»ºç«‹è³‡æ–™å¤¾\n1 2 3 mkdir -p first-try-transaction-isolation/non-repeatable-read cd first-try-transaction-isolation/non-repeatable-read touch docker-compose.yml docker-compose é…ç½®\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 version: \u0026#39;3.1\u0026#39; services: db: container_name: pg image: postgres:14-alpine restart: always environment: POSTGRES_DB: postgres POSTGRES_USER: postgres POSTGRES_PASSWORD: postgres working_dir: /usr/src # ç›´æ¥æŠŠç¾åœ¨è³‡æ–™å¤¾å…§å®¹æ˜ å°„è‡³å»ºç«‹çš„containerä¸­ï¼Œcopyæ‰€éœ€æª”æ¡ˆé€²å»æ¯”è¼ƒå¥½ï¼Œé€™é‚Šåƒ…ç‚ºäº†æ–¹ä¾¿æ“ä½œ volumes: - .:/usr/src å•Ÿå‹• container çš„é †åºä¸å½±éŸ¿æ˜ å°„åˆ° container ä¸­çš„æª”æ¡ˆï¼Œé€™é‚Šå°±å…ˆå•Ÿå‹•\n1 sudo docker-compose up -d å»ºç«‹ sql æª”\ninitdb.sql\n1 2 3 4 5 6 7 8 BEGIN; DROP TABLE IF EXISTS accounts; CREATE TABLE accounts(id SERIAL PRIMARY KEY, balance INT); INSERT INTO accounts(balance) VALUES(500); INSERT INTO accounts(balance) VALUES(500); COMMIT; alice.sql(è¨»è§£é‚£è¡Œè¡¨ç¤ºè¨­å®šæ­¤transactionçš„éš”é›¢ç­‰ç´š)\n1 2 3 4 5 6 7 8 9 BEGIN; -- SET TRANSACTION ISOLATION LEVEL REPEATABLE READ; SELECT balance FROM accounts WHERE id = 1; SELECT balance FROM accounts WHERE id = 2; COMMIT; transfer.sql\n1 2 3 4 5 6 7 8 BEGIN; UPDATE accounts SET balance = balance + 100 WHERE id = 1; UPDATE accounts SET balance = balance - 100 WHERE id = 2; COMMIT; å»ºç«‹ shell script\nlab.sh\n1 2 3 4 5 6 7 8 9 10 11 #!/bin/sh path=/usr/src/non-repeatable-read # åŸ·è¡Œ initdb ä¸­çš„ query åˆå§‹åŒ–å¯¦é©—ç’°å¢ƒ psql -U postgres -f $path/initdb.sql --out log.txt # å°‡å…©å€‹åŸ·è¡Œ transaction æ”¾åˆ°èƒŒæ™¯ä¸¦ç™¼åŸ·è¡Œ psql -U postgres -f $path/alice.sql \u0026amp; psql -U postgres -f $path/transfer.sql \u0026amp; start.sh\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 #!/bin/sh RED=\u0026#39;\\033[0;31m\u0026#39; BLUE=\u0026#39;\\033[0;34m\u0026#39; GREEN=\u0026#39;\\033[0;32m\u0026#39; NC=\u0026#39;\\033[0m\u0026#39; path=/usr/src/non-repeatable-read cycle=300 # åŸ·è¡Œæ¬¡æ•¸ snapshotAfterTransaction=0 # å¦ä¸€ç­† transaction commit å‰å–å¾—çš„å¿«ç…§è¨ˆæ•¸ snapshotBeforeTransaction=0 # å¦ä¸€ç­† transaction commit å¾Œå–å¾—çš„å¿«ç…§è¨ˆæ•¸ snapshotNonRepeatable=0 # å¦ä¸€ç­† transaction ä¸­å–åˆ°ä¸åŒå¿«ç…§è¨ˆæ•¸ for i in $(seq 1 $cycle); do # åŸ·è¡Œ lab.sh ä¸­çš„æŒ‡ä»¤ï¼Œä¸¦éæ¿¾å‡ºæœ‰400ã€500ã€600çš„çµæœ output=$(sh $path/lab.sh | grep -E \u0026#39;400|500|600\u0026#39;) # å„²å­˜å„ç¨®ç‹€æ³çµæœ ## å…©ç­†è³‡æ–™çš†æ˜¯å¦ä¸€ç­† transaction commit å¾Œçš„å¿«ç…§ snapshot1=$(echo $output | grep \u0026#39;600 400\u0026#39;) ## å…©ç­†è³‡æ–™çš†æ˜¯å¦ä¸€ç­† transaction begin å‰çš„å¿«ç…§ snapshot2=$(echo $output | grep \u0026#39;500 500\u0026#39;) ## ç¬¬ä¸€ç­†è³‡æ–™ç‚ºå¦ä¸€ç­† transaction begin å‰çš„å¿«ç…§ï¼Œç¬¬äºŒç­†å‰‡ç‚º transaction commit å¾Œçš„å¿«ç…§ snapshot3=$(echo $output | grep \u0026#39;500 400\u0026#39;) if [ ! -z \u0026#34;$snapshot1\u0026#34; ] then let snapshotAfterTransaction++ echo -e \u0026#34;${GREEN}$snapshot1${NC}\u0026#34; fi if [ ! -z \u0026#34;$snapshot2\u0026#34; ] then let snapshotBeforeTransaction++ echo -e \u0026#34;${BLUE}$snapshot2${NC}\u0026#34; fi if [ ! -z \u0026#34;$snapshot3\u0026#34; ] then let snapshotNonRepeatable++ echo -e \u0026#34;${RED}$snapshot3${NC}\u0026#34; fi # ä¸‰ç¨®ç‹€æ³çµæœçµ±è¨ˆ if [ $i -eq $cycle ] then echo -e \u0026#34;${GREEN}AfterTransaction: ${snapshotAfterTransaction}\\n${BLUE}BeforeTransaction: ${snapshotBeforeTransaction}\\n${RED}Non-repeatable: $snapshotNonRepeatable${NC}\u0026#34; fi done æª”æ¡ˆæº–å‚™å¥½ä¹‹å¾Œï¼ŒåŸ·è¡Œ start.sh å³å¯é–‹å§‹å¯¦é©—ï¼Œä½¿ç”¨ time -p å¯ä»¥å¾—çŸ¥åŸ·è¡Œæ™‚é–“\n1 time -p sh start.sh å¯¦é©—çµæœ Read committed (postgres é è¨­ç­‰ç´š) ä½¿ç”¨é è¨­éš”é›¢ç­‰ç´šï¼Œ300æ¬¡å¯¦é©—ä¸­æœ‰8æ¬¡å¾—åˆ°æœ‰å•é¡Œçš„çµæœã€‚\nRepeatable Read è¨­å®š SET TRANSACTION ISOLATION LEVEL REPEATABLE READ å¾Œï¼Œ300æ¬¡å¯¦é©—ä¸­ç„¡ç™¼ç”Ÿä¸æ­£ç¢ºçš„çµæœï¼Œç›¸å°çš„å–å¾—å¦ä¸€äº¤æ˜“å¾Œçš„è³‡æ–™æ¬¡æ•¸è¼ƒå°‘ã€‚\nç¸½çµ å¦‚æœå†å°‡å¯¦é©—æ¬¡æ•¸æ‹‰é«˜æˆ–è¨±çµæœæœƒæ›´æº–ç¢ºï¼Œä¸éæˆ‘ä¹Ÿä¸æ˜¯å¾ˆç¢ºå®šé€™å€‹åšæ³•æœ‰æ²’æœ‰å…¶ä»–å•é¡Œï¼Œåªæ˜¯è¦ºå¾—èƒ½å¤ é‡ç¾åŒæ¨£çš„å•é¡Œä¸¦ä¸”å»è§£æ±ºå®ƒï¼Œæ˜¯ä¸€ä»¶è »æœ‰æˆå°±çš„äº‹ï¼Œé€™æ¬¡åªæœ‰å¯« Non-repeatable Read(read skew) çš„å¯¦é©—ï¼Œä¹‹å¾Œæœ‰ç©ºå†è©¦è©¦é‡ç¾ Phantom Read(write skew)ã€‚ åƒè€ƒè³‡æ–™ ç¶­åŸºç™¾ç§‘-å¤šç‰ˆæœ¬ä¸¦è¡Œæ§åˆ¶ Crunchydata Tutorials - Transactions PostgreSQL 14 transaction-iso PostgreSQL MVCC ç°¡ä»‹ PostgreSQL äº¤æ˜“éš”é›¢ SQL å¤§å°äº‹ è³‡æ–™åº« Transaction \u0026amp; Lock ç­†è¨˜ è³‡æ–™å·¥ç¨‹å¸«ä¿®ç…‰ä¹‹è·¯ Part II ","date":"2022-10-22T17:57:01.549Z","image":"https://blog.zerolr.net/assets/images/pg.jpeg","permalink":"https://blog.zerolr.net/p/2022/10/22/first-try-transaction-isolation/","title":"ã€PostgreSQLã€‘åˆæ¢ Transaction Isolation"},{"content":"é€™ç¯‡ç´€éŒ„åœ¨ docker busybox ä¸­ä½¿ç”¨ shell script åŒæ™‚åŸ·è¡Œå¤šå€‹æŒ‡ä»¤ï¼Œæ¯”è¼ƒä½¿ç”¨ \u0026amp; å°‡å‘½ä»¤å¸¶åˆ°èƒŒæ™¯åŸ·è¡Œèˆ‡åœ¨å‰æ™¯åŸ·è¡Œæ™‚çš„ç‹€æ³ï¼Œå¦‚ç†è§£æœ‰èª¤ä¹Ÿæ­¡è¿ç³¾æ­£ã€‚\nç¨‹å¼ç¢¼æ”¾åœ¨ github: https://github.com/zeroLR/concurrency-on-sh\nå¯¦é©—ç’°å¢ƒ Mac M1 Docker 20.10.17 Docker Compose 2.2.3 Docker Image: busybox:latest å»ºç«‹å¯¦é©—ç’°å¢ƒ å»ºç«‹è³‡æ–™å¤¾ ã€‚\n1 2 mkdir concurrency-on-sh cd concurrency-on-sh åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ç”¢ç”Ÿæœ¬æ¬¡å¯¦é©—æª”æ¡ˆã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt;\u0026gt; foreground.sh #!/bin/sh sleep 3 ; echo \u0026#34;First job has been completed.\u0026#34; sleep 9 ; echo \u0026#34;Next job has been completed.\u0026#34; sleep 6 ; echo \u0026#34;All jobs have been completed.\u0026#34; EOF cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt;\u0026gt; background.sh #!/bin/sh sleep 3 \u0026amp; echo $! sleep 9 \u0026amp; echo $! sleep 6 \u0026amp; echo $! wait -n echo \u0026#34;First job has been completed.\u0026#34; wait -n echo \u0026#34;Next job has been completed.\u0026#34; wait echo \u0026#34;All jobs have been completed.\u0026#34; EOF cat \u0026lt;\u0026lt; \u0026#39;EOF\u0026#39; \u0026gt;\u0026gt; zombie.sh #!/bin/sh for i in `seq 1 10` do sleep 10 \u0026amp; echo $! done wait EOF ä½¿ç”¨ docker æˆ– docker-compose å•Ÿå‹• containerï¼Œå°‡å¯¦é©—æª”æ¡ˆ mount è‡³ container ä¸­ã€‚\n1 2 # docker command sudo docker run -dti --restart always --workdir /home --mount type=bind,source=\u0026#34;$(pwd)/\u0026#34;,target=/home --name busybox busybox ash 1 2 3 4 5 6 7 8 9 10 11 12 13 # concurrency-on-sh/docker-compose.yml version: \u0026#34;3.1\u0026#34; services: busybox: container_name: busybox image: busybox:latest stdin_open: true tty: true restart: always working_dir: /home command: ash volumes: - .:/home 1 2 # docker-compose sudo docker-compose up -d é–‹å•Ÿå…©å€‹ shell ï¼Œéƒ½ä½¿ç”¨ docker exec é€²å…¥ container çš„ shell ä¸­ã€‚\n1 sudo docker exec -ti busybox busybox ash å…¶ä¸­ä¸€å€‹ shell åŸ·è¡Œ top é–‹å•Ÿç³»çµ±ç›£è¦–(æŒ‰ 1 å¯ä»¥é¡¯ç¤ºå„å€‹ CPU è³‡æº)ï¼Œå¾…æœƒå¯¦é©—æ™‚æ–¹ä¾¿è§€å¯Ÿ process çš„å¢æ¸›éç¨‹ã€‚\nå‰æ™¯åŸ·è¡Œ ä¸€èˆ¬åœ¨ shell ä¸­æœªåŠ ä¸Š \u0026amp; çš„å‘½ä»¤å°±æœƒæ”¾åœ¨å‰æ™¯è™•ç†ï¼Œä¸”ä¸€æ¬¡åªæœƒè™•ç†ä¸€å€‹ processï¼Œä½¿ç”¨ shell script åŸ·è¡Œå¤šå€‹å‘½ä»¤æ™‚ï¼Œä¹Ÿæ˜¯ä¸€æ¬¡åªç”¢ç”Ÿä¸€å€‹ processï¼š\n1 time -p sh foreground.sh ä½¿ç”¨ time -p åŸ·è¡Œå‘½ä»¤ï¼Œæœƒå°‡ time -p å¾Œçš„å‘½ä»¤ä½œç‚ºå…¶å­ç¨‹åºåŸ·è¡Œï¼Œå†ç”±é€™å€‹å­ç¨‹åºä½œç‚ºçˆ¶ç¨‹åºåŸ·è¡Œ shell script ï¼Œç”¢ç”Ÿå‡ºæ–°çš„ç¨‹åº(æœ‰é»ç¹å£ XD)ï¼Œå¾…æ‰€æœ‰å­ç¨‹åºéƒ½åŸ·è¡Œå®Œç•¢å¾Œï¼Œå›å‚³å¾ç¨‹åºåŸ·è¡Œåˆ°çµæŸæ‰€ç¶“éçš„æ™‚é–“ã€‚\nç¬¬ä¸€å€‹å­ç¨‹åºç­‰å¾… 3 ç§’ï¼š\né–‹å§‹ç¬¬äºŒå€‹å­ç¨‹åºç­‰å¾… 9 ç§’ï¼Œå›å‚³ç¬¬ä¸€å€‹å­ç¨‹åºçµæŸå¾ŒåŸ·è¡Œçš„è¨Šæ¯ï¼š\né–‹å§‹ç¬¬ä¸‰å€‹å­ç¨‹åºç­‰å¾… 6 ç§’ï¼Œå›å‚³ç¬¬äºŒå€‹å­ç¨‹åºçµæŸå¾ŒåŸ·è¡Œçš„è¨Šæ¯ï¼š\næ‰€æœ‰ç¨‹åºçµæŸï¼Œå›å‚³è¨Šæ¯èˆ‡åŸ·è¡Œæ™‚é–“ï¼Œç¸½å…±èŠ±è²» 3+6+9 = 18 ç§’ï¼š\nèƒŒæ™¯åŸ·è¡Œ ç¾åœ¨å°‡å‰æ™¯åŸ·è¡Œçš„å‘½ä»¤æ”¾åˆ°èƒŒæ™¯åŸ·è¡Œï¼Œä¸¦å›å‚³å­ç¨‹åº PIDï¼Œä½¿ç”¨ wait ç­‰å¾…ç¨‹åºçµæŸï¼š\n1 time -p sh background.sh åŒæ™‚ç”¢ç”Ÿä¸‰å€‹å­ç¨‹åºï¼Œæ”¾åœ¨èƒŒæ™¯ç”± Linux å»åšä¸¦ç™¼æˆ–å¹³è¡Œè™•ç†ï¼Œå…¶ä¸­ CPU çš„æ¬„ä½è¡¨ç¤ºç•¶ä¸‹é€™å€‹ç¨‹åºæ˜¯ç”±å“ªå€‹ CPU è™•ç†çš„ï¼š\nç¬¬ä¸€å€‹å­ç¨‹åºçµæŸï¼Œæ­¤æ™‚å…¶ä»–å­ç¨‹åºç¹¼çºŒå€’æ•¸ä¸­ï¼š\nç¬¬ä¸‰å€‹å­ç¨‹åºå…ˆçµæŸäº†ï¼Œå› ç‚ºå·²ç¶“å€’æ•¸å®Œç•¢ï¼š\næœ€å¾Œç¬¬äºŒå€‹å­ç¨‹åºçµæŸï¼Œç¸½å…±èŠ±è²» 9 ç§’ï¼š\né€™é‚Šçš„ä¾‹å­åŠå‘½ä»¤çš„é‡éƒ½èˆ‰å¾—å¾ˆå°‘ï¼Œå»ºè­°å¯ä»¥è‡ªå·±è©¦è©¦ç”¨ for loop å»ç”¢ç”Ÿå¤§é‡çš„å‘½ä»¤åŸ·è¡Œï¼Œä¸éé‚„è¦è€ƒæ…®å–®æ ¸åŠå¤šæ ¸çš„ç³»çµ±ä¸Šè™•ç†çš„å·®ç•°å–”ï¼ å¯ä»¥åƒè€ƒ Concurrency ç¨‹å¼è¨­è¨ˆ - HackMD ã€‚\næ®­å±ç¨‹åº ç¨‹åºè¢«æ­£å¸¸å›æ”¶ æˆ‘å€‘å…ˆä¾†çœ‹çœ‹æœ‰æ­£å¸¸ä½¿ç”¨ wait ç­‰å¾…ç¨‹åºçµæŸçš„ç‹€æ³ï¼š\n1 2 # use wait time -p sh zombie.sh å‘½ä»¤åŸ·è¡Œä¸­ï¼Œecho å…ˆå°‡æ‰€æœ‰å·²ç”¢ç”Ÿç¨‹åºçš„ PID é¡¯ç¤ºå‡ºä¾†ï¼Œè§€å¯Ÿä»¥ä¸‹çµæœ :\næ¯å€‹ç¨‹åºçš„ PPID(çˆ¶ç¨‹åº) æ˜¯èª°ï¼Œçˆ¶ ç”¢ç”Ÿ(â†’) å­ container â†’ shell(ash) shell(ash) â†’ time -p sh zombie.sh time -p sh zombie.sh â†’ sh zombie.sh sh zombie.sh â†’ sleep time -p sh zombie.sh ç¨‹åºåœ¨å‰æ™¯åŸ·è¡Œä¸¦ç­‰å¾…ä¸­ å‘½ä»¤çµæŸï¼Œæ‰€æœ‰çµæŸçš„å­ç¨‹åºéƒ½è¢«å…¶çˆ¶ç¨‹åºå›æ”¶ï¼Œç¨‹åºåŸ·è¡Œæ™‚é–“å…±ç´„ 10 ç§’(ä¸¦ç™¼åŸ·è¡Œ)ï¼š\nç¨‹åºçµæŸå¾Œæœªè¢«çˆ¶ç¨‹åºå›æ”¶ å†ä¾†è©¦è©¦ä¸ä½¿ç”¨ wait æ™‚ï¼Œç¨‹åºåŸ·è¡Œå®Œçš„ç‹€æ³ï¼š\n1 2 # not use wait time -p sh zombie.sh å‘½ä»¤åŸ·è¡Œå¾Œé¦¬ä¸ŠçµæŸï¼Œèˆ‡å‰é¢çš„ç‹€æ³æœ‰äº›ä¸åŒï¼š\nç¨‹åºåŸ·è¡Œæ™‚é–“ç´„ 0.01 ç§’ï¼Œé€™é‚Šçš„åŸ·è¡Œæ™‚é–“åªåŒ…å« time -p sh zombie.sh åŠ sh zombie.sh ç¨‹åº æ¯å€‹ sleep ç¨‹åºå…¶ PPID ç‚º 1ï¼Œè€Œé€™å€‹ PID ç‚º 1 çš„ç¨‹åºæ˜¯ container å»ºç«‹å¾Œç”¢ç”Ÿçš„ç¬¬ä¸€å€‹ç¨‹åºï¼Œä¹Ÿå°±æ˜¯æœ€å‰é¢ docker run æ™‚çš„ command æ‰€ç”¢ç”Ÿçš„ ç¨‹åºçµæŸå¾Œï¼Œå…¶çˆ¶è¡Œç¨‹æ²’æœ‰å›æ”¶å­ç¨‹åºï¼Œå­ç¨‹åºè®Šæˆ æ®­å±ç¨‹åºï¼š\né‚£éº¼ç‚ºä»€éº¼æ²’ç”¨ wait å°±æœƒè®“ç¨‹åºè®Šæˆç”± PID 1 çš„ç¨‹åºä¾†ç”¢ç”Ÿå‘¢ï¼Ÿ\næˆ‘å€‘å¾ wait çš„ manual page ä¸­å¯ä»¥å¾—çŸ¥ :\nIf a parent process terminates, then its \u0026ldquo;zombie\u0026rdquo; children (if any) are adopted by init(1), (or by the nearest \u0026ldquo;subreaper\u0026rdquo; process as defined through the use of the prctl(2) PR_SET_CHILD_SUBREAPER operation); init(1) automatically performs a wait to remove the zombies.\nå–”ï½ç”±æ–¼æœªä½¿ç”¨ wait å»ç­‰å¾… zombie.sh ç”¢ç”Ÿçš„èƒŒæ™¯ç¨‹åºåŸ·è¡Œå®Œç•¢ï¼Œæ‰€ä»¥åŸ·è¡Œ zombie.sh çš„ç•¶ä¸‹ç¨‹åºå°±çµæŸäº†ï¼Œç”¢ç”Ÿå‡ºä¾†çš„å­ç¨‹åºæ‰¾ä¸åˆ°çˆ¹ï¼Œæœ€å¾Œå°±è¢«éš”å£è€ç‹ init(1) æ”¶é¤Šäº†(Xï¼Œè€Œé€™å€‹ç¨‹åºåœ¨é€™å€‹å¯¦é©—ä¸­æ˜¯ç”± docker run çš„ command - ash æ‰€ç”¢ç”Ÿçš„ï¼Œæœ€å¾Œå¯ä»¥é€éä»¥ä¸‹å‘½ä»¤å»é€²å…¥ container ä¸­ PID 1 çš„ç¨‹åºï¼š\n1 2 3 4 # é€€å‡ºç›®å‰çš„ shell exit # é€²å…¥ sudo docker attach busybox ç„¶å¾ŒæŒ‰å€‹ enterï¼Œæ®­å±ç¨‹åºå°±æœƒè¢«å›æ”¶äº† ã€‚\nçµæœæ¯”è¼ƒ æœ‰ wait æ²’ wait ç”±å…¶çˆ¶ç¨‹åºé€²è¡Œç­‰å¾…ä¸¦å›æ”¶ ç”± PID 1 çš„ç¨‹åº init(1) æ¥æ”¶å­ç¨‹åºï¼Œä¸¦è‡ªå‹•åŠ å…¥ wait å»çµæŸæ®­å±ç¨‹åº è€çˆ¹çµ¦ä½ é  è€çˆ¹è·‘è·¯ï¼Œéš”å£è€ç‹å¥½å¿ƒæ”¶é¤Š ç¸½çµ åŸæœ¬åªæ˜¯è¦ç´€éŒ„æ€éº¼æ¨£åŒæ™‚ä¸‹å‘½ä»¤ï¼Œçµæœæƒ³è¦å¼„å€‹æ¨¡æ“¬å¯¦é©—å°±æœƒæŒ–æ›´å¤šå‘ï¼Œä¸éä¹Ÿç®—æ¯”ä»¥å‰æ›´æ·±å…¥ä¸€é»é»æ¢è¨é‹ä½œéç¨‹ä¸­çš„åŸç†ï¼Œé€Ÿé€Ÿå¦¹ï¼ åƒè€ƒè³‡æ–™ Symmetric Multi-Processing - Linux kernel concurrency sources busybox - procps/top.c Linux ä¸­ Sleep å’Œ Wait å‘½ä»¤çš„ä½¿ç”¨æ–¹å¼ LINUX å­¸ç¿’æ—¥èªŒ - æŠŠå‘½ä»¤æ”¾åˆ°èƒŒæ™¯åŸ·è¡Œ Background, zombie, daemon and without ctty - are these concepts connected? How do you run multiple programs in parallel from a bash script? time(1) â€” Linux manual page wait(2) â€” Linux manual page docker attach Concurrency ç¨‹å¼è¨­è¨ˆ - HackMD ","date":"2022-10-16T19:56:56.431Z","permalink":"https://blog.zerolr.net/p/2022/10/16/concurrency-on-sh/","title":"ã€Linuxã€‘Concurrency on sh"},{"content":" Blog æ¬å®¶å®Œå¾Œï¼Œéœ€è¦é‡æ–°é…ç½® Netlify CMS æ‰€éœ€çš„æª”æ¡ˆæ‰èƒ½å•Ÿç”¨ï¼Œä¹‹å‰çš„ Blog æ˜¯ç”¨ Jekyll ç”Ÿæˆçš„ï¼Œèˆ‡ç¾åœ¨ Hugo åƒæ•¸é…ç½®çš„éƒ¨åˆ†ç›¸ä¼¼ï¼Œä¸é Hugo çš„æª”æ¡ˆçµæ§‹èˆ‡ Jekyll é‚„æ˜¯æœ‰äº›è¨±ä¸åŒï¼Œé€™ç¯‡æœƒè¨˜éŒ„æˆ‘èª¿æ•´äº†å“ªäº›åƒæ•¸ï¼Œå»ºç«‹æ–°åˆ†æ”¯å°å…¥ CMS åŠŸèƒ½éƒ¨ç½²æ¸¬è©¦ï¼Œæœ€å¾Œé€é CMS å»ºç«‹æ–‡ç« å¾Œçš„ markdown æœƒé•·ä»€éº¼æ¨£å­ã€‚\n2022-09-06 Debugï¼š æ–‡ç« ä¸­ä½¿ç”¨ cms é€™å€‹åç¨±ä½œç‚ºæ¸¬è©¦åŠŸèƒ½åˆ†æ”¯ï¼Œæœƒå°è‡´ Netlify CMS åœ¨æ›´æ–° repo æ™‚å‡ºéŒ¯ï¼Œè«‹ä½¿ç”¨ cms ä»¥å¤–çš„åç¨±ï¼Œè©³ç´°åƒè€ƒï¼šhttps://github.com/netlify/netlify-cms/issues/3065\nNetlify ç¶²ç«™å»ºç«‹ ä½¿ç”¨æ­¤åŠŸèƒ½å‰éœ€è‡³ Netlify å»ºç«‹ä¸€å€‹ç¶²ç«™ï¼Œåƒè€ƒæˆ‘ä¹‹å‰çš„æ–‡ç«  Netlify CMS å°å…¥ GitHub Pages è¨˜éŒ„ ã€‚\nConfig é…ç½®æ¯”è¼ƒ æ›´è©³ç´°çš„é…ç½®å¯ä»¥åƒè€ƒ Configuration Options\nä¹‹å‰åœ¨ Jekyll ä¸Šä½¿ç”¨çš„ config å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 backend: name: github repo: zerolr/zerolr.github.io branch: main site_domain: musing-swanson-deda90.netlify.com publish_mode: editorial_workflow media_folder: \u0026#34;images/uploads\u0026#34; collections: - name: \u0026#34;blog\u0026#34; # Used in routes, e.g., /admin/collections/blog label: \u0026#34;Blog\u0026#34; # Used in the UI folder: \u0026#34;_posts/\u0026#34; # The path to the folder where the documents are stored create: true # Allow users to create new documents in this collection slug: \u0026#34;{{year}}-{{month}}-{{day}}-{{slug}}\u0026#34; # Filename template, e.g., YYYY-MM-DD-title.md fields: # The fields for each document, usually in front matter - { label: \u0026#34;Title\u0026#34;, name: \u0026#34;title\u0026#34;, widget: \u0026#34;string\u0026#34; } - { label: \u0026#34;Publish Date\u0026#34;, name: \u0026#34;date\u0026#34;, widget: \u0026#34;datetime\u0026#34; } - { label: \u0026#34;Categories\u0026#34;, name: \u0026#34;categories\u0026#34;, widget: \u0026#34;list\u0026#34; } - { label: \u0026#34;Tags\u0026#34;, name: \u0026#34;tags\u0026#34;, widget: \u0026#34;list\u0026#34; } - { label: \u0026#34;Body\u0026#34;, name: \u0026#34;body\u0026#34;, widget: \u0026#34;markdown\u0026#34; } ç¾åœ¨ Hugo ä¸Šä½¿ç”¨çš„ config å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 backend: name: github repo: zerolr/zerolr.github.io branch: master # Branch to update (optional; defaults to master) site_domain: musing-swanson-deda90.netlify.com media_folder: static/assets/images public_folder: assets/images publish_mode: editorial_workflow collections: - name: \u0026#34;blog\u0026#34; label: \u0026#34;Blog\u0026#34; folder: \u0026#34;content/post\u0026#34; create: true slug: \u0026#34;{{year}}-{{month}}-{{day}}-{{slug}}\u0026#34; editor: preview: false fields: - { label: \u0026#34;Title\u0026#34;, name: \u0026#34;title\u0026#34;, widget: \u0026#34;string\u0026#34; } - { label: \u0026#34;Slug\u0026#34;, name: \u0026#34;slug\u0026#34;, widget: \u0026#34;string\u0026#34; } - { label: \u0026#34;Description\u0026#34;, name: \u0026#34;description\u0026#34;, widget: \u0026#34;string\u0026#34; } - { label: \u0026#34;Cover\u0026#34;, name: \u0026#34;image\u0026#34;, widget: \u0026#34;string\u0026#34; } - { label: \u0026#34;Categories\u0026#34;, name: \u0026#34;categories\u0026#34;, widget: \u0026#34;list\u0026#34;, summary: \u0026#34;{{fields.category}}\u0026#34;, field: { label: \u0026#34;Category\u0026#34;, name: \u0026#34;category\u0026#34;, widget: \u0026#34;string\u0026#34; }, } - { label: \u0026#34;Tags\u0026#34;, name: \u0026#34;tags\u0026#34;, widget: \u0026#34;list\u0026#34;, summary: \u0026#34;{{fields.tag}}\u0026#34;, field: { label: \u0026#34;Tag\u0026#34;, name: \u0026#34;tag\u0026#34;, widget: \u0026#34;string\u0026#34; }, } - { label: \u0026#34;Publish Date\u0026#34;, name: \u0026#34;date\u0026#34;, widget: \u0026#34;datetime\u0026#34; } - { label: \u0026#34;Body\u0026#34;, name: \u0026#34;body\u0026#34;, widget: \u0026#34;markdown\u0026#34; } ä¸»è¦çš„é…ç½®ç°¡ä»‹ repo: blog çš„ repo åç¨±\nbranch: é€é CMS ä¿®æ”¹çš„éƒ¨åˆ†æœƒæ›´æ–°è‡³é€™å€‹åˆ†æ”¯ä¸­\nsite_domain: å¡«å…¥åœ¨ Netlify ä¸Šå»ºç«‹ç¶²ç«™çš„ domain\nmedia_folder: åœ¨ CMS ä¸­ä¸Šå‚³çš„åœ–ç‰‡å­˜æ”¾è³‡æ–™å¤¾è·¯å¾‘\npublic_folder: éƒ¨ç½²å¾Œæ–‡ç« å­˜å–è³‡æºçš„è³‡æ–™å¤¾è·¯å¾‘\npublish_mode: æ–‡ç« çš„ç™¼å¸ƒæ¨¡å¼ï¼Œæœ‰åˆ†ä¸€èˆ¬åŠæš«å­˜æ¨¡å¼\ncollections: å¯ä»¥å®šç¾©å¤šç¨®æ–‡ç« é…ç½®ï¼Œä¾‹ï¼štech-artcle, life-article\nname: æ–‡ç« çš„é¡å‹åç¨± label: æ–‡ç« é…ç½®åç¨±ï¼Œåƒ…å½±éŸ¿é¡¯ç¤ºæ–‡å­— folder: æ–‡ç« è³‡æ–™å¤¾è·¯å¾‘ create: æ–°å¢æ–‡ç« åŠŸèƒ½ slug: è‡ªå‹•ç”¢ç”Ÿçš„æ–‡ç« æª”æ¡ˆåç¨±ï¼Œä¾‹ï¼š2022-09-04-new-post editor(preview): é è¦½æ–‡ç« åŠŸèƒ½ fields: ä¾æ“šåº•ä¸‹çš„é…ç½®åœ¨æª”æ¡ˆä¸­ç”¢ç”Ÿå°æ‡‰çš„æ¬„ä½ è‹¥æ˜¯ä½¿ç”¨ VSCode ç·¨è¼¯ï¼Œå¯ä»¥å°‡æ»‘é¼ ç§»è‡³åƒæ•¸ä¸Šï¼Œæœƒé¡¯ç¤ºè©³ç´°èªªæ˜\næˆ‘ä¸»è¦æ”¹äº†ä»€éº¼ï¼Ÿ media_folder: Hugo åœ¨ build å¾Œæœƒå°‡ static ä¸­çš„æª”æ¡ˆæ”¾åœ¨ root ä¸‹ï¼Œ è€Œ CMS ä¸Šå‚³çš„åœ–ç‰‡æœƒå­˜åœ¨é€™å€‹è·¯å¾‘ï¼Œå¦‚æ­¤ build å¾Œçš„è³‡æºæ‰å¯è¢«ç¶²é å­˜å– public_folder: æ‰¿ä¸Šï¼Œæ–‡ç« å¾æ­¤è·¯å¾‘å­˜å–åœ–ç‰‡ fields: åŸæœ¬ç…§ä¹‹å‰çš„é…ç½®æ™‚ï¼Œæœƒæœ‰ Tags èˆ‡ Categories åªèƒ½è¼¸å…¥ä¸€å€‹å­—ä¸²çš„å•é¡Œï¼Œä¸”å­—ä¸²ä¸­ä¸èƒ½æœ‰ç©ºæ ¼ï¼Œå¾Œä¾†åœ¨é€™ç¯‡ issueä¸­æ‰¾åˆ°æ–¹æ³•è™•ç†ï¼Œåˆ©ç”¨ summary ä¾†çµ„åˆä¸åŒåƒæ•¸ï¼Œçµæœå¦‚ä¸‹åœ– å»ºç«‹æ–°åˆ†æ”¯åŠ å…¥ Netlify CMS éƒ¨ç½²æ¸¬è©¦ åœ¨åŠ å…¥ Netlify CMS çš„æª”æ¡ˆå‰ï¼Œå…ˆåˆ†åˆ¥å»ºç«‹çµ¦ master åŠ cms åˆ†æ”¯ä½¿ç”¨çš„ workflowsã€‚\nè§€å¯Ÿæ¨¡æ¿æä¾›çš„ deploy.yml é€™æ®µè¡¨ç¤ºç•¶ repo è¢« push æˆ– pull_request åˆ° master åˆ†æ”¯æ™‚ï¼ŒæœƒåŸ·è¡Œé€™å€‹ yml æª”çš„éƒ¨ç½²å·¥ä½œã€‚\n1 2 3 4 5 on: push: branches: [master] pull_request: branches: [master] ä¸­é–“é‚„æœ‰å®‰è£å¥—ä»¶ã€æš«å­˜è³‡æºã€å»ºç½®éœæ…‹æª”æ¡ˆç­‰ç­‰æµç¨‹ï¼Œç›´æ¥æ‹‰åˆ°æœ€ä¸‹é¢ Deploy çš„åœ°æ–¹ï¼Œé€™é‚Šè¡¨ç¤ºéƒ¨ç½² gh-pages ä¸­çš„æª”æ¡ˆã€‚\n1 2 3 4 5 6 7 - name: Deploy ğŸš€ uses: JamesIves/github-pages-deploy-action@4.1.4 with: branch: gh-pages folder: public clean: true single-commit: true å»ºç«‹çµ¦æ–°åˆ†æ”¯éƒ¨ç½²ç”¨çš„ deploy.yml å°‡åŸæœ¬çš„ deploy.yml æ”¹ç‚º deploy_master.yml,ï¼Œä¸¦å»ºç«‹ä¸€å€‹ deploy_cms.ymlï¼Œä¿®æ”¹è§¸ç™¼éƒ¨ç½²çš„åˆ†æ”¯ç‚º cmsï¼Œä»¥åŠéƒ¨ç½²åˆ†æ”¯æ”¹ç‚º gh-pages-feature-testã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 # deploy_cms.yml name: Deploy to Github Pages - Feture test on: push: branches: [cms] pull_request: branches: [cms] jobs: build: runs-on: ubuntu-latest steps: - uses: actions/checkout@v2 - name: Cache Hugo resources uses: actions/cache@v2 env: cache-name: cache-hugo-resources with: path: resources key: ${{ env.cache-name }} - uses: actions/setup-go@v2 with: go-version: \u0026#34;^1.17.0\u0026#34; - run: go version - name: Cache Go Modules uses: actions/cache@v2 with: path: | ~/.cache/go-build ~/go/pkg/mod key: ${{ runner.os }}-go-${{ hashFiles(\u0026#39;**/go.sum\u0026#39;) }} restore-keys: | ${{ runner.os }}-go- - name: Setup Hugo uses: peaceiris/actions-hugo@v2 with: hugo-version: \u0026#34;latest\u0026#34; extended: true - name: Build run: hugo --minify --gc - name: Deploy ğŸš€ uses: JamesIves/github-pages-deploy-action@4.1.4 with: branch: gh-pages-feature-test folder: public clean: true single-commit: true ä¿®æ”¹å®Œå¾Œåœ¨ master åˆ†æ”¯åŠ å…¥ç´€éŒ„ã€‚\n1 2 git add . git commit -m \u0026#34;feat: update workflow for master branch, add new workflow for cms branch\u0026#34; æ­¤æ™‚é€™å€‹ç‰ˆæœ¬çš„ç´€éŒ„æœƒç•™åœ¨å·²å»ºç«‹å¥½ master èˆ‡ cms åˆ†æ”¯ç”¨çš„ workflows ä¸Šï¼Œä¸‹ä¸€æ­¥å†å°‡ Netlify CMS æ‰€éœ€çš„æª”æ¡ˆåŠ å…¥ã€‚\nå»ºç«‹ cms åˆ†æ”¯ä¸¦å°‡ Netlify CMS æª”æ¡ˆåŠ å…¥ é¦–å…ˆå»ºç«‹ä¸¦åˆ‡æ›è‡³ cms åˆ†æ”¯ã€‚\n1 git checkout -b cms å°‡ Netlify CMS æ‰€éœ€çš„æª”æ¡ˆæ”¾åœ¨ static ç›®éŒ„åº•ä¸‹ï¼Œå¾Œé¢ build å¾Œæ‰èƒ½è®“ admin è¼¸å‡ºåœ¨æ ¹ç›®éŒ„ä¸­ã€‚\n1 root - static - admin - config.yml - index.html å»ºç«‹ commit è¨˜éŒ„æœ¬æ¬¡ä¿®æ”¹ã€‚\n1 2 git add . git commit -m \u0026#34;feat: add netlify cms\u0026#34; æ­¤æ™‚ cms åˆ†æ”¯æœƒé ˜å…ˆ master åˆ†æ”¯ä¸€å€‹ commitï¼Œå¯ä»¥åƒè€ƒä¸‹é¢çš„è£œå……ï¼Œæ¥ä¸‹ä¾†è¦æº–å‚™éƒ¨ç½²ä¸Šå»ã€‚\nè£œå……ï¼š git branch åˆ†æ”¯å»ºç«‹ é»æ“Šå±•é–‹ é€™é‚Šç”¨ç¯„ä¾‹ä¾†è§£é‡‹åˆ†æ”¯ï¼Œæ–°é–‹è³‡æ–™å¤¾åŠ å…¥ä¸€å€‹ blog.txt æª”æ¡ˆï¼Œä¸¦å»ºç«‹ git ç’°å¢ƒåŠ å…¥ commitã€‚\n1 2 3 4 5 6 mkdir git-branch-test cd git-branch-test git init echo \u0026#34;This is blog file\u0026#34; \u0026gt;\u0026gt; blog.txt git add . git commit -m \u0026#34;initial commit\u0026#34; ä½¿ç”¨ git log æŸ¥çœ‹ç‹€æ…‹ï¼Œç›®å‰æœ‰ä¸€å€‹ commit ï¼ŒHEAD è¡¨ç¤ºç›®å‰æ‰€åœ¨çš„ commitï¼Œç®­é ­æŒ‡å‘çš„ä½ç½®è¡¨ç¤º commit æ‰€åœ¨çš„åˆ†æ”¯ã€‚\n1 2 git log --oneline d5bf87b (HEAD -\u0026gt; master) initial commit å»ºç«‹åˆ†æ”¯ä¸¦åˆ‡æ›éå»ï¼Œä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤é”æˆï¼ŒåŠ ä¸Š -b å¯ä»¥æ–°å¢åˆ†æ”¯åŒæ™‚åˆ‡æ›éå»ã€‚\n1 git checkout -b cms æª¢æŸ¥æ‰€åœ¨åˆ†æ”¯ç”¨ git branch æŒ‡ä»¤ï¼Œ*ç¬¦è™Ÿä½ç½®è¡¨ç¤ºæ‰€åœ¨åˆ†æ”¯ã€‚\n1 2 3 git branch master *cms åŠ å…¥ config.yml æª”æ¡ˆä¸¦å»ºç«‹ commit å¾Œï¼Œä½¿ç”¨ git log æŸ¥çœ‹ç‹€æ…‹ï¼Œç”±æ–¼æ˜¯åŸºæ–¼æ­¤æ™‚çš„ master åˆ†æ”¯ä¸Šå»ºç«‹åˆ†æ”¯ï¼Œåœ¨ cms åˆ†æ”¯ä¸­æœƒæœ‰ master åˆ†æ”¯çš„ commitï¼Œä¸”æ¯” master åˆ†æ”¯é ˜å…ˆä¸€å€‹ commit ï¼Œæ„æ€å°±æ˜¯æ¯” master åˆ†æ”¯é ˜å…ˆä¸€ç­†ä¿®æ”¹ç´€éŒ„ã€‚\n1 2 3 4 5 6 echo \u0026#34;This is config file\u0026#34; \u0026gt;\u0026gt; config.yml git add . git commit -m \u0026#34;feat: add config.yml\u0026#34; git log --oneline 09103bc (HEAD -\u0026gt; cms) feat: add config.yml d5bf87b (master) initial commit æˆ‘å€‘å¯ä»¥åˆ‡å›å» master åˆ†æ”¯æŸ¥çœ‹ git logï¼Œå‰›æ‰å‰é¢é‚£å€‹ commit åŠ config.yml ä¸è¦‹äº†ï¼ å› ç‚ºå‰›æ‰æ˜¯åœ¨ cms åˆ†æ”¯ä¸­å»ºç«‹ commit ï¼Œæ–°å¢ config.yml é€™ç­†ç´€éŒ„åªæœ‰åœ¨ cms çš„åˆ†æ”¯ä¸­æ‰èƒ½çœ‹åˆ°ï¼Œæ‰€ä»¥å¯ä»¥ä¾æ“šæƒ³åŠ å…¥çš„åŠŸèƒ½é–‹å°æ‡‰çš„åˆ†æ”¯ã€‚\n1 2 3 4 5 git checkout master Switched to branch \u0026#39;master\u0026#39; git log --oneline d5bf87b (HEAD -\u0026gt; master) initial commit å¯ä»¥æŠŠ branch æƒ³åƒæˆæ˜¯è³‡æ–™å¤¾ï¼Œé–‹åˆ†æ”¯å°±æ˜¯å¾ master è³‡æ–™å¤¾è¤‡è£½ä¸€ä»½ä¸¦é‡æ–°å‘½åæˆ cmsï¼Œcommit å°±æ˜¯å°è³‡æ–™å¤¾å…§çš„å…§å®¹åšç·¨è¼¯ï¼Œä»¥ç¯„ä¾‹ä¾†èªªæœ€å¾Œ master æœ‰ä¸€ä»½æª”æ¡ˆï¼Œè€Œ cms å‰‡æœ‰å…©ä»½æª”æ¡ˆå›‰ï¼\néƒ¨ç½²æ¸¬è©¦ç‰ˆç¶²ç«™ å°‡ç¨‹å¼ push è‡³ é ç«¯ repo çš„ cms åˆ†æ”¯ä¸Šï¼Œpush é ç«¯ä¸å­˜åœ¨çš„åˆ†æ”¯æ™‚ GitHub æœƒå¹«æˆ‘å€‘å»ºç«‹ï¼Œä¸”å›  cms åˆ†æ”¯è¢« push é‚„æœƒè§¸ç™¼ deploy_cms.yml çš„ workflowã€‚\n1 git push origin cms push å®Œå¾Œåˆ°ç¶²é æŸ¥çœ‹ GitHub repoï¼Œå·¦é‚Šæ¸…å–®å¯ä»¥çœ‹åˆ°ç›®å‰æœ‰çš„åˆ†æ”¯ï¼Œå¯ä»¥æ¯”è¼ƒ master èˆ‡ cms ä¸­çš„æª”æ¡ˆæ˜¯å¦å¦‚é æœŸä¸åŒã€‚\nè‡³ repo ä¸­çš„ Actions æŸ¥çœ‹çµæœï¼Œå¯ä»¥çœ‹åˆ°åŸ·è¡Œå·¥ä½œæµç¨‹çš„æª”æ¡ˆåŠåç¨±ï¼Œä»¥åŠåº•ä¸‹å®Œæˆéçš„å·¥ä½œã€‚\nå¾… workflow å·¥ä½œå®Œæˆå¾Œï¼Œè‡³ repo â†’ Settings â†’ Pages åº•ä¸‹ï¼Œåœ¨ Branch çš„æ¬„ä½ä¸­é¸æ“‡ä½ è¦éƒ¨ç½²ç¶²ç«™çš„åˆ†æ”¯ï¼Œé€™é‚Šé¸æ“‡ç”± deploy_cms.yml æ‰€ç”¢ç”Ÿçš„ gh-pages-feature-test åˆ†æ”¯ï¼ŒæŒ‰ä¸‹ Save å¾Œå°±æœƒé–‹å§‹éƒ¨ç½²ã€‚\néƒ¨ç½²ä¸­çš„éç¨‹ä¸€æ¨£å¯ä»¥åœ¨ Actions ä¸­æŸ¥çœ‹ï¼Œå¯ä»¥é»é€²å»çœ‹æ›´è©³ç´°çš„éç¨‹ï¼Œå¤±æ•—çš„éŒ¯èª¤è¨Šæ¯åœ¨é€™é‚Šéƒ½å¯ä»¥æŸ¥å¾—åˆ°ã€‚\næˆåŠŸéƒ¨ç½²å¾Œé–‹å•Ÿç¶²ç«™é€²å…¥ CMS ç®¡ç†ç•«é¢ï¼Œç™»å…¥å·²æˆæ¬Šçš„ GitHub å¸³è™Ÿå¾Œå°±å¯ä»¥é–‹å§‹å»ºç«‹æ–‡ç« å›‰ï¼\nåˆä½µæ–°åŠŸèƒ½è‡³ master åˆ†æ”¯ æ–°å¢çš„åŠŸèƒ½æ¸¬è©¦å®Œæˆå¾Œï¼Œå°±å¯ä»¥åˆä½µå› master åˆ†æ”¯é€²è¡Œæ­£å¼ç¶²ç«™çš„éƒ¨ç½²ï¼Œåœ¨ repo å¯ä»¥çœ‹åˆ°æç¤ºä½ åˆä½µåˆ†æ”¯çš„è¨Šæ¯ã€‚\né»æ“Š Compare \u0026amp; pull request ï¼Œé€™é‚Šæœƒæª¢æŸ¥æœ‰ç„¡è¡çªï¼Œå¾€ä¸‹æ‹‰å¯ä»¥çœ‹åˆ°å¾ cms åˆ†æ”¯ åˆä½µå› master åˆ†æ”¯æ™‚çš„å…§å®¹å·®ç•°ï¼Œç¢ºèªéƒ½æ²’å•é¡Œå¾Œå¡«å¯« commit è¨Šæ¯ï¼ŒæŒ‰ä¸‹ Create pull request å°±æˆåŠŸç™¼é€åˆä½µè«‹æ±‚ã€‚\né€™æ™‚åœ¨ Pull requests ä¸­å°±æœ‰å€‹åˆä½µè«‹æ±‚ç”¢ç”Ÿï¼Œåˆä½µå‰å¯ä»¥æª¢æŸ¥ Files changed ä¸­çš„è³‡è¨Šï¼Œç¢ºå®šè®Šå‹•çš„å…§å®¹éƒ½æ²’æœ‰å•é¡Œå¾Œå°±å¯ä»¥åˆä½µäº†ã€‚\nåˆä½µä¹‹å¾Œè¨˜å¾—å›åˆ° Settings â†’ Pages ä¸­å°‡éƒ¨ç½²çš„ Branch æ›´æ”¹ç‚º gh-pages ä½œç‚ºæ­£å¼éƒ¨ç½²çš„ç¶²ç«™ã€‚\nä½¿ç”¨ CMS å»ºç«‹æ–‡ç«  é€™é‚Šå»ºç«‹æ–‡ç« å¡«å…¥å…§å®¹ï¼Œæ³¨æ„ SLUG æ¬„ä½æœƒè®Šæˆæ–‡ç« çš„ç¶²ç«™è·¯å¾‘ï¼Œå»ºè­°ä»¥è‹±æ–‡åŠ åˆ†éš”ç¬¦è™Ÿçš„æ ¼å¼å‘½åï¼Œè®“äººçœ‹ç¶²å€å°±çŸ¥é“ä¸»é¡Œæ˜¯ä»€éº¼ï¼ŒCOVER æ¬„ä½ç‚ºæ–‡ç« é è¦½åœ–ï¼Œå¡«çµ•å°è·¯å¾‘æœƒå¾éƒ¨ç½²çš„æª”æ¡ˆä¸­æŸ¥æ‰¾ï¼Œä¹Ÿå¯ä½¿ç”¨åœ–ç‰‡ URLã€‚\næª¢æŸ¥å®Œæ²’å•é¡Œå¾Œå°±å¯ä»¥ç™¼å¸ƒæ–‡ç« å›‰ï¼\né€é CMS ç™¼ä½ˆçš„æ–‡ç« æª”æ¡ˆï¼Œä¸Šæ–¹çš„æ¬„ä½é…ç½®å°±æ˜¯ä¾ç…§ç·¨è¼¯å™¨ä¸­çš„å…§å®¹ç”¢ç”Ÿçš„ï¼\nè‹¥æœ‰å•Ÿç”¨ publish_mode: editorial_workflow ï¼Œæ–‡ç« æœƒåˆ†æˆä¸‰ç¨®éšæ®µç‹€æ…‹å„²å­˜ï¼Œåˆ†åˆ¥ç‚º Draft, In Review, Readyï¼Œä¸€é–‹å§‹å„²å­˜æœƒåœ¨ Draft ç‹€æ…‹ï¼Œåªæœ‰å°‡ç‹€æ…‹åˆ‡æ›ç‚º Ready æ‰èƒ½ publish è‡³ç¶²ç«™ä¸­ã€‚\nç•¶æ–‡ç« ä¸æ–·ä¿®æ”¹å„²å­˜æ™‚ï¼Œç¶²ç«™æœƒå…ˆå»ºç«‹æš«å­˜çš„ commit ï¼Œæ¯ä¸€æ¬¡çš„ Save éƒ½æœƒå»ºç«‹ä¸€æ¬¡ï¼Œç›´åˆ° publish å¾Œæ‰æœƒä¸€ä½µ push è‡³ repo ä¸­ï¼Œä¸¦ä¸”æœƒè‡ªå‹•å»ºç«‹ pull request å»åˆä½µä¸­é–“ç”¢ç”Ÿçš„ commit å† merge å› repo ä¸­ã€‚\nå®‰å…¨å•é¡Œ å°±è·Ÿä½¿ç”¨å…¶ä»–éœ€ç™»å…¥çš„ç¶²ç«™æœå‹™ä¸€æ¨£ï¼Œæœ‰ä»¥ä¸‹å¹¾å€‹é»éœ€æ³¨æ„ï¼š\né™¤éæ˜¯è‡ªå·±çš„é›»è…¦ï¼Œåœ¨å…¶ä»–é›»è…¦ä¸Šè«‹é–‹ç„¡ç—•è¦–çª—ä½¿ç”¨ã€‚ ä½¿ç”¨æ™‚æœƒéœ€è¦ç™»å…¥ GitHubï¼Œåœ¨ CMS é€™é‚Šç™»å…¥å®Œå¾Œæœƒç™¼ç¾ GitHub é‚£é‚Šä¹Ÿç™»å…¥äº†ï¼Œæ‰€ä»¥è«‹è¨˜å¾—é›¢é–‹æˆ–ä¸ç”¨æ™‚ç™»å‡ºã€‚ ä½¿ç”¨æœªè¨»å†Š provider çš„ GitHub å¸³è™Ÿç™»å…¥æ™‚æœƒè¢«æ“‹ä¸‹ä¾†ï¼Œè‹¥è¦å¢åŠ å…±åŒç·¨è¼¯çš„å¸³è™Ÿï¼Œéœ€åœ¨å…¶å¸³è™Ÿä¸‹å»ºç«‹ OAuth APPï¼Œä¸¦ä¸”å°‡ Client ID åŠ Secret æä¾›çµ¦ç®¡ç†å“¡å» provider ã€‚ ç¸½çµ é‡æ–°å†è·‘éä¸€éå®‰è£æµç¨‹å¾Œå°é…ç½®åˆæ›´ç†Ÿæ‚‰äº†ä¸€é»ï¼Œä¹Ÿç™¼ç¾ CMS é€£å´é‚Šæ¬„ä½é‚£äº›é é¢ä¹Ÿèƒ½ç·¨è¼¯ï¼Œä¹‹å¾Œæœƒå†æ›´æ–°ä¸Šå»ã€‚åŒæ™‚ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡å˜—è©¦å¦å¤–é–‹åˆ†æ”¯åŠ å…¥æ–°åŠŸèƒ½æ¸¬è©¦éƒ¨ç½²ï¼Œåœ¨å˜—è©¦çš„éç¨‹ä¸­ä¸€ç›´åœ¨æƒ³é€™ç¨®åšæ³•æ˜¯å¦åˆé©ï¼Œè‹¥å°æœ¬ç¯‡åšæ³•æœ‰ä»»ä½•çœ‹æ³•éå¸¸æ­¡è¿ç•™è¨€æŒ‡æ•™ï¼\nåƒè€ƒè³‡æ–™ Netlify CMS - Hugo List widget form input prevents whitespace and commas Configuration Options å»ºç«‹åˆ†æ”¯ã€æ•™å­¸ 1 ä½¿ç”¨åˆ†æ”¯ã€‘ | é€£çŒ´å­éƒ½èƒ½æ‡‚çš„ Git å…¥é–€æŒ‡å— | è²æ ¼æ¨‚ï¼ˆBacklogï¼‰ ","date":"2022-09-05T14:30:19.036Z","image":"https://blog.zerolr.net/post/images/cover/hugo-wide.jpeg","permalink":"https://blog.zerolr.net/p/2022/09/05/netlify-cms-import-hugo/","title":"ã€Hugoã€‘Netlify CMS å°å…¥ Hugo ç¶²ç«™ç´€éŒ„"},{"content":" ç”¨äº†ä¸€é™£å­ç°¡ç´„é¢¨çš„ jekyll å¾Œï¼Œè¦ºå¾—é‚„æ˜¯å¤ªç©ºäº†ï¼Œè¦æ‰¾ç›¸é—œä¸»é¡Œçš„æ–‡ç« é‚„è¦æ‰¾å¥½ä¹…ï¼Œæ²’æœ‰é è¦½åœ–å¯ä»¥å¿«é€Ÿæª¢è¦–æƒ³çœ‹çš„æ–‡ç« ï¼ŒåŠ ä¸Šä¹‹å‰å°±å¾ˆæƒ³ç”¨ Hugo ä¾†éƒ¨ç½²å€‹äºº blog äº†ï¼Œé€™æ¬¡è²·äº†å€‹ Domain å¾Œå°±æƒ³ä¾†é‡æ–°è£æ½¢ä¸€ä¸‹ blogã€‚ Hugo Themes ä¸­çœŸçš„ä¸€å †å¤§ç¥åšè¶…å¥½çœ‹çš„æ¨¡æ¿ RRRï¼Œé€™ç¯‡ç´€éŒ„å¦‚ä½•ä½¿ç”¨ Hugo Themes ä¸­çš„ Stack æ¨¡æ¿ï¼Œè§€å¯Ÿå…¶ä¸­æª”æ¡ˆä»¥åŠéƒ¨åˆ†è¨­å®šä¿®æ”¹ï¼Œè‡³æ–¼ CMS çš„éƒ¨åˆ†å¯ä»¥åƒè€ƒä¹‹å‰å¯«çš„ Netlify CMS å°å…¥ GitHub Pages è¨˜éŒ„ï¼Œä¸éåœ¨ Hugo ä¸­å°å…¥çš„æµç¨‹æœ‰äº›ä¸åŒï¼Œå°±ç•™åˆ°ä¸‹ä¸€ç¯‡ç´€éŒ„å›‰ï¼\nå®‰è£ Hugo å®‰è£ Hugo çš„éƒ¨åˆ†å°±ä¸èªªäº†ï¼Œéƒ½åœ¨å®˜æ–¹æ–‡ä»¶ä¸­ï¼\nå¾ä½œè€…æä¾›çš„ Template å»ºç«‹ repo ä½¿ç”¨ hugo-theme-stack-starter å»ºç«‹ repo å¾Œå¦‚ä¸‹ï¼Œä½œè€…: Jimmy Caiã€‚\nè§€å¯Ÿæª”æ¡ˆèˆ‡èª¿æ•´ .github/workflows/deploy.yml å°‡ repo clone åˆ°é›»è…¦ä¸­ï¼Œå¯ä»¥çœ‹åˆ°åœ¨ .github/workflows ä¸­ï¼Œä½œè€…å·²ç¶“å¯«å¥½éƒ¨ç½²ç¶²ç«™çš„deploy.ymlæª”äº†ï¼Œåœ¨é›»è…¦ä¸­æ¸¬è©¦å®Œç”¨ git push å¾Œå°±æœƒå¹«ä½ éƒ¨ç½²è‡³ gh-pages çš„åˆ†æ”¯å›‰ï¼\nç•¶ push æ–°çš„ commit ä¸Šå»æ™‚ï¼ŒGitHub Actions æœƒæ ¹æ“š workflows ä¸­çš„ yml é€²è¡Œä¸€é€£ä¸²çš„å‹•ä½œå°‡ç¶²ç«™éƒ¨ç½²å®Œæˆï¼Œæƒ³äº†è§£å¦‚ä½•åšåˆ°çš„å¯ä»¥åƒè€ƒ GitHub Actions ã€‚\n.github/workflows/update-theme.yml åœ¨ .github/workflows ä¸­é‚„å¯ä»¥çœ‹åˆ°å¦ä¸€å€‹æª”æ¡ˆ update-theme.yml ï¼Œçœ‹äº†å…§å®¹å¾Œå€‹äººè¦ºå¾—æ˜¯ç”¨ä¾†è‡ªå‹•æ›´æ–°æ¨¡æ¿æª”çš„æµç¨‹ï¼Œæˆ‘è‡ªå·±ä¸éœ€è¦å°±åˆªæ‰äº†ã€‚\n.github/.devcontainer åœ¨ .devcontainer ä¸­é‚„æœ‰æä¾› Dockerfile èƒ½å¤ å°‡ç¶²ç«™åŒ…è£æˆ Docker Imageï¼Œå°æ–¼æƒ³éƒ¨ç½²åœ¨ä¸åŒå¹³å°ä¸Šçš„äººä¾†èªªå¾ˆæ–¹ä¾¿ï¼Œå¯ä»¥å…ˆç•™è‘—æ—¥ç”¨æœ‰æ©Ÿæœƒè©¦è©¦ã€‚\nconfig/_default ç¶²ç«™çš„æ¨™é¡Œã€å¤–è§€ä¸»é¡Œã€èªè¨€ã€é ­åƒã€é€£çµâ€¦åŸºæœ¬ä¸Šéƒ½ç”±é€™é‚Šçš„æª”æ¡ˆé€²è¡Œè¨­å®šï¼Œåƒè€ƒ Configure Hugo æˆ–æ˜¯ç¶²è·¯ä¸Šæœ‰å¾ˆå¤šæ–‡ç« è§£èªªå¦‚ä½•è¨­å®šå–”ï¼\ncontent/post æ¨¡æ¿é è¨­å·²ç¶“æœ‰ä¸€ç¯‡ hello-world çš„æ–‡ç« ï¼Œå¯ä»¥åƒè€ƒå…§æ–‡æ ¼å¼æ’°å¯«æ–‡ç« ï¼Œé€™é‚Šæˆ‘å°±æŠŠä¹‹å‰å¯«çš„æ¬éä¾†ï¼Œä¹Ÿèƒ½åŠ ä¸Šæ¨™é¡Œåœ–ç‰‡ã€‚\nLocal ç«¯åŸ·è¡Œ/å»ºç½®ç¶²ç«™ åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„ä¸­åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤é–‹å•Ÿç¶²ç«™æª¢è¦–ã€‚\n1 hugo server åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„ä¸­åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤å»ºç½®ç¶²ç«™ï¼Œéœæ…‹æª”æ¡ˆè¼¸å‡ºåœ¨ public è³‡æ–™å¤¾ä¸­ï¼ŒæŒ‡ä»¤éƒ¨åˆ†åƒè€ƒ hugo commands ã€‚\n1 hugo --minify --gc éƒ¨ç½²è‡³ GitHub pages å¯ä»¥ç›´æ¥æŠŠå‰›æ‰ build å‡ºä¾†çš„éœæ…‹æª”ç›´æ¥æ¨ä¸Šå»ï¼Œä¸éé€™é‚Šå°±åˆ©ç”¨ GitHub Actions ä¾†å®Œæˆå»ºç½®åŠéƒ¨ç½²çš„å‹•ä½œã€‚\nç¸½çµ ç›´æ¥æ¬åˆ¥äººæä¾›çš„æ±è¥¿ä¾†ç”¨æ˜¯å¾ˆæ–¹ä¾¿ï¼Œä½†å°æ–¼ Hugo æœ¬èº«æ˜¯å¦‚ä½•è—‰ç”±æ¨¡æ¿çš„æ–¹å¼ä¾†ç”¢ç”Ÿç¶²é ä¸ç†Ÿæ‚‰çš„è©±ï¼Œå¾€å¾Œè¦ä¿®æ”¹å°±ä¸å®¹æ˜“äº†ï¼Œå¦‚æœæƒ³æ›´å®¢è£½åŒ–è‡ªå·±çš„ blog ï¼Œæœ€å¥½é‚„æ˜¯æŠŠå®˜æ–¹æ–‡ä»¶çœ‹ç†Ÿæ‰æ˜¯ç‹é“ï¼\nåƒè€ƒè³‡æº Hugo Themes Theme - Stack ","date":"2022-09-03T00:00:00Z","image":"https://blog.zerolr.net/post/images/cover/hugo-wide.jpeg","permalink":"https://blog.zerolr.net/p/2022/09/03/hugo-new-theme/","title":"ã€Hugoã€‘åˆâ€¦åˆæ”¹ä¸»é¡Œ!!!"},{"content":" åŸæœ¬éƒ¨è½æ ¼æ–‡ç« çš„æ–°å¢æˆ–æ›´æ–°éœ€è¦ä¿®æ”¹æª”æ¡ˆï¼Œå°±åœ¨æƒ³æœ‰æ²’æœ‰åƒæ˜¯ Wordpress é‚£ç¨®æœ‰å¾Œå°èƒ½å¤ ç›´æ¥æ–°å¢æ–‡ç« çš„åŠŸèƒ½å¯ä»¥ä½¿ç”¨ï¼Œç¿»ä¸€ä¸‹ google å°±æ‰¾åˆ°ä¸€å€‹è »å¤šäººç”¨çš„ Netlify CMSï¼Œå˜—è©¦å°å…¥é€™å€‹éƒ¨è½æ ¼å¾Œè¦ºå¾—çœŸçš„å¾ˆæ–¹ä¾¿ã€‚èƒ½å¤ åœ¨åŸæœ¬çš„ç¶²ç«™ä¸­æ–°å¢ä¸€å€‹æ§åˆ¶å°ç®¡ç†æ–‡ç« ï¼Œæ–‡ç« çš„æ–°å¢/ä¿®æ”¹/åˆªé™¤åªè¦ä¸€éµå°±å¹«ä½ å®Œæˆ commit, publish, deploy é€™äº›æ­¥é©Ÿï¼Œé›–ç„¶åŸç†é‚„æ²’æœ‰å¾ˆæ·±å…¥äº†è§£ï¼Œä½†ä¸ç”¨æ¯æ¬¡é–‹ VSCode èµ·ä¾†æ”¹æª”æ¡ˆæ–°å¢æ–‡ç« å°±æ˜¯èˆ’æœå•¦(å·²çŸ¥ç”¨ç«)ï¼\nå°å…¥æµç¨‹ å»ºç«‹ GitHub OAuth APP å‰å¾€ GitHub Dev Settings å»ºç«‹ GitHub OAuth APPï¼Œä½¿ç”¨é€™å€‹ CMS æ™‚æœƒéœ€è¦ç™»å…¥è‡ªå·±çš„ GitHubã€‚\nAuthorization callback URL å¡«å…¥https://api.netlify.com/auth/doneï¼Œé€é GitHub OAuth APP ç™»å…¥æ™‚å–å¾—çš„ Access token æœƒå†æ‹¿å» Authorization callback URL é€™å€‹ API(Serve-to-server)é©—è­‰ã€‚\nNetlify è¨»å†Š Provider å‰å¾€ Netlify å»ºç«‹ä¸€å€‹ç¶²ç«™ï¼Œrepo ä»»æ„é¸æ“‡å³å¯ï¼Œç¶²ç«™ä¸¦ä¸æœƒéƒ¨ç½²åœ¨é¸æ“‡çš„ repo ä¸Šã€‚\nå‰å¾€ Site settings ï¼Œè¨˜ä¸‹é€™å€‹ç¶²ç«™çš„åç¨±å¾Œé¢æœƒç”¨åˆ°ï¼Œæ ¼å¼æ‡‰è©²é•·å¾—åƒ octopus-cat-123456ã€‚\nå´é‚Šæ¬„é¸æ“‡ Domain Management ï¼Œæ–°å¢ Custom domains ç‚º you.github.io ã€‚\nå´é‚Šæ¬„é¸æ“‡ Access control ï¼Œé¸æ“‡ OAuth ï¼Œé»æ“Š Install providerã€‚\nProvider é¸æ“‡ GitHubï¼Œè¼¸å…¥å¾ GitHub OAuth APP ä¸­çš„ Client ID èˆ‡ Client Secretã€‚\nåœ¨ç¶²ç«™ä¸­å•Ÿç”¨ Netlify CMS ç®¡ç†é é¢ åœ¨è‡ªå·±éƒ¨è½æ ¼çš„æ ¹è³‡æ–™å¤¾ä¸­æ–°å¢ admin è³‡æ–™å¤¾ï¼Œå»ºç«‹ index.html èˆ‡ config.ymlï¼Œå…§å®¹å¦‚ä¸‹ï¼Œåœ¨ config.yml ä¸­è¨˜å¾—å°‡ repo èˆ‡ site_domain ä¿®æ”¹æˆè‡ªå·±çš„éƒ¨è½æ ¼èˆ‡å‰›å‰›è¨˜ä¸‹çš„ Netlify ç¶²ç«™åç¨±ï¼Œä»¥åŠè¦æ³¨æ„è‡ªå·±éƒ¨è½æ ¼çš„ branch æ˜¯å¦è·Ÿ config ä¸­çš„ç›¸åŒã€‚\nadmin/index.html 1 2 3 4 5 6 7 8 9 10 11 12 \u0026lt;!DOCTYPE html\u0026gt; \u0026lt;html\u0026gt; \u0026lt;head\u0026gt; \u0026lt;meta charset=\u0026#34;utf-8\u0026#34; /\u0026gt; \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34; /\u0026gt; \u0026lt;title\u0026gt;Content Manager\u0026lt;/title\u0026gt; \u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;!-- Include the script that builds the page and powers Netlify CMS --\u0026gt; \u0026lt;script src=\u0026#34;https://unpkg.com/netlify-cms@^2.10.187/dist/netlify-cms.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; admin/config.yml 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 backend: name: github repo: you/you.github.io branch: master site_domain: octopus-cat-123456.netlify.com media_folder: \u0026#34;images/uploads\u0026#34; collections: - name: \u0026#34;blog\u0026#34; # Used in routes, e.g., /admin/collections/blog label: \u0026#34;Blog\u0026#34; # Used in the UI folder: \u0026#34;_posts/\u0026#34; # The path to the folder where the documents are stored create: true # Allow users to create new documents in this collection slug: \u0026#34;{{year}}-{{month}}-{{day}}-{{slug}}\u0026#34; # Filename template, e.g., YYYY-MM-DD-title.md fields: # The fields for each document, usually in front matter - { label: \u0026#34;Title\u0026#34;, name: \u0026#34;title\u0026#34;, widget: \u0026#34;string\u0026#34; } - { label: \u0026#34;Publish Date\u0026#34;, name: \u0026#34;date\u0026#34;, widget: \u0026#34;datetime\u0026#34; } - { label: \u0026#34;Tags\u0026#34;, name: \u0026#34;tags\u0026#34;, widget: \u0026#34;list\u0026#34; } - { label: \u0026#34;Body\u0026#34;, name: \u0026#34;body\u0026#34;, widget: \u0026#34;markdown\u0026#34; } æ¨é€ä¸Šå» GitHub å¾Œï¼Œå°±å¯é–‹å•Ÿ https://you.github.io/admin é€²å…¥ CMS ç®¡ç†ç³»çµ±å›‰ï¼\nè£œå…… å¦‚æœæƒ³è¦æš«æ™‚ä¿å­˜æ–°æ–‡ç« æˆ–ä¿®æ”¹ï¼Œå¯ä»¥åœ¨ config.yml åŠ ä¸Šä¸‹æ–¹çš„åƒæ•¸ ï¼Œå°±å¯ä»¥é–‹å•Ÿæš«å­˜ç›¸é—œåŠŸèƒ½äº†ï¼Œé‚„åˆ†æˆ Draft, In review, Ready ä¸‰ç¨®éšæ®µä¾†ç®¡ç†å„å€‹æ–‡ç« é€²åº¦å–”ï¼\n1 publish_mode: editorial_workflow ç¸½çµ å¯¦éš›ç”¨éå¾Œæœ‰äº›é»éœ€è¦æ³¨æ„ï¼Œé è¨­æ–‡ç« é€£çµæœƒç”¨ titile ä½œç‚º pathï¼Œè‹¥è¶…é 50 å€‹å­—å°±æœƒå ±éŒ¯(å¿˜è¨˜å“ªé‚Šçš„é™åˆ¶)ï¼Œæ–‡å­—åœ¨ url ä¸­æœƒè¢«è½‰æ›ç‚º base64 æ ¼å¼ï¼Œå¾ˆå®¹æ˜“å°±æœƒè¶…éä¸Šé™ï¼Œå¦ä¸€å€‹å•é¡Œæ˜¯ç”¨ CMS ç™¼å¸ƒæ–‡ç« å¾Œï¼Œbot æœƒå¹«ä½  merge æ–°çš„ post åˆ° repo ä¸­ï¼Œè‹¥æƒ³ä¿®æ”¹æª”æ¡ˆè¨˜å¾—è¦å…ˆ git pull åŒæ­¥ã€‚\nåƒè€ƒè³‡æ–™ Just 3 Steps: Adding Netlify CMS to Existing GitHub Pages Site Within 10 Minutes NetlifyCMS - Overview NetlifyCMS - Publish Mode What is \u0026ldquo;User authorization callback URL\u0026rdquo; for? Authorizing OAuth Apps - GitHub Docs ","date":"2022-03-05T01:17:30.996Z","image":"https://blog.zerolr.net/post/images/cover/netlify-cms.png","permalink":"https://blog.zerolr.net/p/2022/03/05/netlify-cms-import-github-pages/","title":"Netlify CMS å°å…¥ GitHub Pages è¨˜éŒ„"},{"content":" åœ¨ jekyll-next-theme ä¸­å·²ç¶“å°‡ gitalk åŠŸèƒ½æ•´åˆå¥½äº†ï¼Œä½†æ˜¯åœ¨å‡ºç¾ gitalk ç•™è¨€åŠŸèƒ½çš„æ–‡ç« ä»¥å¤–çš„é é¢ï¼Œæœƒå‡ºç¾ä¸€å€‹æ‰¾ä¸åˆ° gitalk-container é€™å€‹ element çš„éŒ¯èª¤è¨Šæ¯ï¼Œå›å»çœ‹ç¨‹å¼ç¢¼ç™¼ç¾ gitalk æœƒåœ¨æ‰€æœ‰é é¢å•Ÿç”¨ï¼Œè©¦è‘—å°‡ gitalk é™åˆ¶åœ¨ post é¡å‹(æ–‡ç« )çš„é é¢ä¸­å•Ÿç”¨å°±æˆåŠŸäº†ã€‚\nè§£æ±ºæ–¹æ³• é–‹å•Ÿ \u0026lt;your_blog\u0026gt;/_includes/_third_party/comments/gitalk.html\nå°‡åŸæœ¬çš„ site.gitalk.enable åˆ¤æ–· åŠ ä¸Šèˆ‡ page.id åš and é‹ç®—ï¼Œåªæœ‰ç•¶é€²å…¥æ–‡ç« æ™‚æ‰å•Ÿç”¨ gitalk\n1 2 3 4 \u0026lt;!-- old --\u0026gt; if site.gitalk.enable \u0026lt;!-- new --\u0026gt; if site.gitalk.enable and page.id ç¸½çµ ç¸½è¦ºå¾—é€™è§£æ±ºæ–¹æ³•ä¸æ€éº¼å„ªï¼Œä½†å° jekyll ä¹Ÿä¸ç†Ÿå°±æ¹Šåˆè‘—ç”¨äº†ã€‚\nåƒè€ƒè³‡æ–™ How can jekyll judge whether it is a page or a post? ","date":"2021-12-22T00:00:00Z","permalink":"https://blog.zerolr.net/p/2021/12/22/jekyll-gitalk-issue/","title":"ã€Jekyllã€‘è§£æ±ºgitalkå•Ÿç”¨å¾ŒéŒ¯èª¤è¨Šæ¯å•é¡Œ"},{"content":" ç”±æ–¼å·¥ä½œä¸Šçš„éœ€æ±‚å…¥æ‰‹äº† MacBook Air M1ï¼Œé †ä¾¿ææ—©ç†Ÿæ‚‰åœ¨ ARM æ¶æ§‹ä¸Šé–‹ç™¼æœƒé‡åˆ°çš„å•é¡Œã€‚ é‡ç”Ÿå¾Œçš„ç¬¬ä¸€ç¯‡å°±ä¾†è¨˜éŒ„ä¸€ä¸‹é€™å€‹ blog æ¶è¨­ä¸­æ‰€é‡åˆ°çš„å•é¡Œå›‰ï¼\nç³»çµ±ç’°å¢ƒ MacOS: Monterey\nç‰ˆæœ¬: 12.1\næ¶æ§‹: aarch64\nä½¿ç”¨è»Ÿé«”/å·¥å…· ruby 2.6.8 jekyll 3.26.0 bundler 1.17.2 æ¶è¨­æµç¨‹ æº–å‚™å¥½è‡ªå·±çš„ Github å¸³è™Ÿã€‚ å»ºç«‹ github page èˆ‡æŒ‘é¸è‡ªå·±å–œæ­¡çš„ jekyll ä¸»é¡Œå¥—ç”¨ï¼Œåƒè€ƒçš„æ–‡ç« æ”¾åœ¨åº•éƒ¨çš„åƒè€ƒè³‡æ–™ä¸­å›‰ã€‚ å˜—è©¦è™•ç† jekyll å®‰è£å•é¡Œ jekyll å®‰è£å¤±æ•— é¦–å…ˆç”¨ gem å®‰è£ jekyllï¼Œçµæœå‡ºç¾ä»¥ä¸‹éŒ¯èª¤è¨Šæ¯ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 $ sudo gem install -n /usr/local/bin jekyll --user-install Successfully installed jekyll-4.2.1 Parsing documentation for jekyll-4.2.1 Before reporting this, could you check that the file you\u0026#39;re documenting has proper syntax: /System/Library/Frameworks/Ruby.framework/Versions/2.6/usr/bin/ruby -c lib/jekyll/commands/doctor.rb RDoc is not a full Ruby parser and will fail when fed invalid ruby programs. The internal error was: (NoMethodError) undefined method `[]\u0026#39; for nil:NilClass ERROR: While executing gem ... (NoMethodError) undefined method `[]\u0026#39; for nil:NilClass jekyll å®‰è£å•é¡Œè§£æ±º æ›´æ–° gem å°±å¯ä»¥æ­£ç¢ºå®‰è£äº†ï¼š\n1 $ sudo gem update å†æ¬¡å®‰è£ï¼š\n1 2 3 4 5 6 $ sudo gem install -n /usr/local/bin jekyll --user-install Successfully installed jekyll-4.2.1 Parsing documentation for jekyll-4.2.1 Installing ri documentation for jekyll-4.2.1 Done installing documentation for jekyll after 0 seconds 1 gem installed ä½†åŸ·è¡Œ sudo jekyll new blog æ™‚å»å™´äº†ä¸€å¤§ä¸²çš„éŒ¯èª¤ï¼Œç›®å‰é‚„ä¸çŸ¥é“æ€éº¼è§£æ±ºï¼Œæ‰€ä»¥æ”¹æˆç›´æ¥ clone jekyll-theme-next æä¾›çš„ç¯„ä¾‹æª”ä¾†åšã€‚\næ”¹å¾ç¯„ä¾‹æª”é€²è¡Œå®‰è£ bundle exec jekyll server å¤±æ•— é¦–å…ˆç…§å®˜æ–¹çš„æ­¥é©Ÿé€²è¡Œå®‰è£ï¼Œåœ¨ä½¿ç”¨bundle install å‰è¦å…ˆ updateï¼š\n1 $ bundle update å°‡å¥—ä»¶éƒ½è£å¥½å¾Œï¼Œå˜—è©¦å•Ÿå‹•å¤±æ•—ï¼š\n1 2 3 4 5 6 $ bundle exec jekyll server /System/Library/Frameworks/Ruby.framework/Versions/2.6/usr/lib/ruby/2.6.0/forwardable.rb:116: warning: already initialized constant Forwardable::VERSION ... Configuration file: /Users/ceyanglab/Documents/github/jekyll-theme-next/_config.yml Dependency Error: Yikes! It looks like you don\u0026#39;t have jemoji or one of its dependencies installed. In order to use Jekyll as currently configured, you\u0026#39;ll need to install this gem. The full error message from Ruby is: \u0026#39;cannot load such file -- nokogiri/nokogiri\u0026#39; If you run into trouble, you can find helpful resources at https://jekyllrb.com/help/! jekyll 3.9.0 | Error: jemoji ä¸€é–‹å§‹ä»¥ç‚ºæ˜¯ jemoji çš„å•é¡Œï¼Œç§»é™¤å¾Œé€£å•Ÿå‹•éƒ½ç„¡æ³•ï¼Œåªå¥½å†è£å›ä¾†ï¼š\n1 2 3 $ bundle exec jekyll server Could not find jemoji-0.12.0 in any of the sources Run `bundle install` to install missing gems. å†æ¬¡æœå°‹è³‡æ–™ï¼ŒæŸ¥åˆ°æœ‰å¯èƒ½é‡è¤‡å®‰è£å¤šå€‹ jekyll å°è‡´å•Ÿå‹•å¤±æ•—ï¼Œé‚£å°±åˆªæ‰å¤šçš„å§ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 $ sudo gem uninstall jekyll You have requested to uninstall the gem: jekyll-3.9.0 github-pages-222 depends on jekyll (= 3.9.0) jekyll-default-layout-0.1.4 depends on jekyll (~\u0026gt; 3.0) jekyll-swiss-1.0.0 depends on jekyll (~\u0026gt; 3.2, development) If you remove this gem, these dependencies will not be met. Continue with Uninstall? [yN] y Successfully uninstalled jekyll-3.9.0 Select gem to uninstall: 1. jekyll-4.2.1 2. jekyll-4.2.1 3. All versions \u0026gt; 2 You have requested to uninstall the gem: jekyll-4.2.1 å†æ¬¡å˜—è©¦å•Ÿå‹•ä¾ç„¶å ±åŒæ¨£çš„éŒ¯ Orzï¼Œä»”ç´°è§€å¯ŸéŒ¯èª¤è¨Šæ¯ç™¼ç¾é—œéµå­—ï¼š\n1 The full error message from Ruby is: \u0026#39;cannot load such file -- nokogiri/nokogiri\u0026#39; å¥—ä»¶å•é¡Œè™•ç† å—¯å¥½æ‡‰è©²æ˜¯ nokogiri é€™å€‹å¥—ä»¶çš„å•é¡Œï¼Œé–‹ gem çš„æ¸…å–®çœ‹ä¸€ä¸‹ï¼š\n1 2 3 4 $ gem list ... nokogiri (1.12.5 arm64-darwin x86_64-darwin, 1.10.1) ... åŒæ™‚æœ‰ arm è·Ÿ x86 ç‰ˆæœ¬çš„å¥—ä»¶å­˜åœ¨ï¼Œåˆªæ‰å…¶ä»–åªç•™ arm çš„è©¦è©¦ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 $ sudo gem uninstall nokogiri Select gem to uninstall: 1. nokogiri-1.12.5-x86_64-darwin 2. nokogiri-1.12.5-x86_64-darwin 3. nokogiri-1.12.5-arm64-darwin 4. All versions \u0026gt; 1 Successfully uninstalled nokogiri-1.12.5-x86_64-darwin Select gem to uninstall: 1. nokogiri-1.12.5-x86_64-darwin 2. nokogiri-1.12.5-arm64-darwin 3. All versions \u0026gt; 1 Successfully uninstalled nokogiri-1.12.5-x86_64-darwin æˆåŠŸå•Ÿå‹•ç¶²ç«™ æœç„¶æ˜¯ nokogiri å¥—ä»¶çš„å•é¡Œï¼Œå¯ä»¥æ­£å¸¸å•Ÿå‹•äº†ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 $ bundle exec jekyll server ... Configuration file: /Users/ceyanglab/Documents/github/jekyll-theme-next/_config.yml Source: /Users/ceyanglab/Documents/github/jekyll-theme-next Destination: /Users/ceyanglab/Documents/github/jekyll-theme-next/_site Incremental build: disabled. Enable with --incremental Generating... Jekyll Feed: Generating feed for posts done in 1.813 seconds. Auto-regeneration: enabled for \u0026#39;/Users/ceyanglab/Documents/github/jekyll-theme-next\u0026#39; Server address: http://127.0.0.1:4000 Server running... press ctrl-c to stop. ç¸½çµ é‡åˆ°å•é¡Œæ™‚å…ˆå¥½å¥½çœ‹éŒ¯èª¤è¨Šæ¯ï¼Œæ‰ä¸æœƒç­”æ¡ˆæ“ºåœ¨çœ¼å‰é‚„åˆ°è™•ç›²è©¦ã€‚\nåƒè€ƒè³‡æ–™ å¾é›¶é–‹å§‹: ç”¨ github pages ä¸Šå‚³éœæ…‹ç¶²ç«™ - sexyoung NexT ä½¿ç”¨æ–‡æª” ","date":"2021-12-20T18:00:00Z","permalink":"https://blog.zerolr.net/p/2021/12/20/jekyll-mac-m1-issue/","title":"ã€Jekyllã€‘Mac M1 å®‰è£ Jekyll è¸©é›·è¨˜éŒ„"}]